name: Build .NET Core projects
description: Build and test .NET Core projects
author: Antoine Milochau
inputs:
  projectsToBuild:
    description: The path to the projects to build - can be a .csproj or a .sln file
    required: true
  projectsToTest:
    description: The path to the projects to test - can be a .csproj or a .sln file
    required: true
  dotnetVersion:
    description: The .NET version to use
    default: ''
  verbosity:
    description: The verbosity of the scripts
    default: minimal
    options:
    - minimal
    - normal
    - detailed
runs:
  using: composite
  steps:
    - name: Setup .NET Core
      if: ${{ inputs.dotnetVersion != '' }}
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: ${{ inputs.dotnetVersion }}
    - name: Build .NET Core application with script
      shell: pwsh
      run: ${{ github.action_path }}/build-netcore.ps1 `
        -projectsToBuild ${{ inputs.projectsToBuild }} `
        -projectsToTest ${{ inputs.projectsToTest }} `
        -verbosity ${{ inputs.verbosity }}
    - name: Upload artifact
      uses: actions/upload-artifact@v3
      with:
        name: build-netcore
        path: ./output
        if-no-files-found: error
        retention-days: 1
    - name: Upload artifact (compressed)
      uses: actions/upload-artifact@v3
      with:
        name: build-netcore
        path: ./output-compressed
        if-no-files-found: error
        retention-days: 1
