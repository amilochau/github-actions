name: Build .NET Core projects
description: Build and test .NET Core projects
author: Antoine Milochau
inputs:
  projectsToBuild:
    description: The path to the projects to build - can be a .csproj or a .sln file
    required: true
  projectsToTest:
    description: The path to the projects to test - can be a .csproj or a .sln file
    required: true
  dotnetVersion:
    description: The .NET version to use
    default: '8.0.x'
  verbosity:
    description: The verbosity of the scripts
    default: minimal
    options:
    - quiet
    - minimal
    - normal
    - detailed
    - diagnostic
runs:
  using: composite
  steps:
    - name: Setup .NET Core
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: ${{ inputs.dotnetVersion }}
    - name: Restore packages
      shell: pwsh
      run: dotnet restore ${{ inputs.projectsToBuild }} --verbosity ${{ inputs.VERBOSITY }}
      env:
        DOTNET_NOLOGO: true
        DOTNET_CLI_TELEMETRY_OPTOUT: true
    - name: Build application
      shell: pwsh
      run: dotnet build ${{ inputs.projectsToBuild }} --configuration Release --no-restore --verbosity ${{ inputs.VERBOSITY }}
      env:
        DOTNET_NOLOGO: true
        DOTNET_CLI_TELEMETRY_OPTOUT: true
    - name: Test application
      shell: pwsh
      run: dotnet test ${{ inputs.projectsToTest }} --configuration Release --no-restore --no-build --verbosity ${{ inputs.VERBOSITY }}
      env:
        DOTNET_NOLOGO: true
        DOTNET_CLI_TELEMETRY_OPTOUT: true
